FROM balenalib/%%BALENA_MACHINE_NAME%%-python

RUN apt-get update && apt-get install -yq \
  python-dev \
  python-rpi.gpio && \
  apt-get clean && rm -rf /var/lib/apt/lists/*

WORKDIR /usr/src/app

COPY requirements.txt requirements.txt
RUN pip install -r requirements.txt

COPY doorbell_sub.py ./

# Enable udevd so that plugged dynamic hardware devices show up in our container.
ENV UDEV=1

CMD ["python", "-u", "doorbell_sub.py"]
